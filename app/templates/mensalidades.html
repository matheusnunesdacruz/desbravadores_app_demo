{% extends "base.html" %}
{% block content %}
<h3>Mensalidades</h3>
<form method="post" class="row g-2 mb-3">
  <div class="col-md-4">
    <select class="form-select" name="desbravador_id" required>
      <option value="">Desbravador...</option>
      {% for d in des %}<option value="{{d.id}}">{{d.nome}}</option>{% endfor %}
    </select>
  </div>
  <div class="col-md-2"><input class="form-control" name="competencia" placeholder="AAAA-MM" required></div>
  <div class="col-md-2"><input type="number" step="0.01" class="form-control" name="valor" placeholder="Valor" required></div>
  <div class="col-md-2"><input type="date" class="form-control" name="data_pagamento" placeholder="Data Pagamento"></div>
  <div class="col-md-1 form-check d-flex align-items-center">
    <input class="form-check-input" type="checkbox" name="pago" value="true" id="pago">
    <label class="form-check-label ms-1" for="pago">Pago</label>
  </div>
  <div class="col-md-1"><button class="btn btn-primary w-100">Adicionar</button></div>
</form>

<table class="table table-striped table-hover">
  <thead><tr><th>ID</th><th>Desbravador</th><th>Comp.</th><th>Valor</th><th>Pago</th><th>Data Pag.</th><th></th></tr></thead>
  <tbody>
    {% for m in data %}
    <tr>
      <td>{{ m.id }}</td>
      <td>{{ m.desbravador.nome }}</td>
      <td>{{ m.competencia }}</td>
      <td>R$ {{ '%.2f'|format(m.valor) }}</td>
      <td>
        <form method="post" action="/mensalidades/{{m.id}}/toggle">
          <button class="btn btn-sm {{ 'btn-success' if m.pago else 'btn-warning' }}">{{ 'Pago' if m.pago else 'Pendente' }}</button>
        </form>
      </td>
      <td>{{ m.data_pagamento or '-' }}</td>
      <td>
        <form method="post" action="/mensalidades/{{m.id}}/delete" onsubmit="return confirm('Excluir?')">
          <button class="btn btn-sm btn-danger">Excluir</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
